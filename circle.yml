machine:
  node:
    version: 6.0.0

dependencies:
  pre:
    - npm install -g typescript
    - npm install -g tsconfig-cli
    - npm install -g electron-packager
    - sudo apt-get install jq

deployment:
  master:
    branch: master
    commands:
      - cd ~/$CIRCLE_PROJECT_REPONAME && npm run package_circleci
      - zip -r `echo ${CIRCLE_ARTIFACTS}/${CIRCLE_PROJECT_REPONAME}_osx.zip` ~/$CIRCLE_PROJECT_REPONAME/build/ancient-night-darwin-x64/
      - zip -r `echo ${CIRCLE_ARTIFACTS}/${CIRCLE_PROJECT_REPONAME}_win.zip` ~/$CIRCLE_PROJECT_REPONAME/build/ancient-night-win32-x64/
      - ./script/release_github.sh `echo ${CIRCLE_PROJECT_REPONAME}_osx.zip`
      - ./script/release_github.sh `echo ${CIRCLE_PROJECT_REPONAME}_win.zip`
     
test:
  pre:
      - cd ~/$CIRCLE_PROJECT_REPONAME/src/main && tsconfig -u && tsc
      - cd ~/$CIRCLE_PROJECT_REPONAME/src/renderer && tsconfig -u && tsc
  override:
    - echo No test, never mind.
